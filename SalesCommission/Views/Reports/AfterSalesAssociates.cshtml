@model SalesCommission.Models.AftermarketReportModel

@{
    ViewBag.Title = "After Sales Report for Associates";
    var applicationPath = Request.ApplicationPath;

    if (applicationPath == "/")
    {
        applicationPath = "";
    }

    System.Globalization.NumberFormatInfo nfi = new System.Globalization.CultureInfo("en-US", false).NumberFormat;
    nfi.CurrencyDecimalDigits = 0;
    nfi.PercentDecimalDigits = 1;
    nfi.PercentPositivePattern = 1;
    nfi.CurrencySymbol = "";



}
@section CSS
{
    <link rel="stylesheet" href="~/Scripts/Chosen/chosen.css">
}

<style type="text/css">
    table.dataTable thead > tr > th.sorting_asc, table.dataTable thead > tr > th.sorting_desc, table.dataTable thead > tr > th.sorting, table.dataTable thead > tr > td.sorting_asc, table.dataTable thead > tr > td.sorting_desc, table.dataTable thead > tr > td.sorting {
        padding-right: 20px;
    }

    table.dataTable thead .sorting:after, table.dataTable thead .sorting_asc:after, table.dataTable thead .sorting_desc:after, table.dataTable thead .sorting_asc_disabled:after, table.dataTable thead .sorting_desc_disabled:after {
        position: absolute;
        bottom: 0px;
        right: 1px;
        display: block;
        font-family: 'Glyphicons Halflings';
        opacity: 0.5;
    }

    .tooltip-inner {
        white-space: pre;
        max-width: none;
    }

    .table thead > tr > th, .table tbody > tr > th, .table tfoot > tr > th, .table thead > tr > td, .table tbody > tr > td, .table tfoot > tr > td {
        padding: 6px;
    }

    .chosen-container {
        vertical-align: top;
        font-size: 14px;
    }

    .chosen-container-multi .chosen-choices {
        border: 1px solid #cccccc;
        border-radius: 4px;
    }

    th.rotate {
        /* Something you can count on */
        height: 150px;
        white-space: nowrap;
    }

        th.rotate > div {
            transform:
            /* Magic Numbers */
            translate(3px, 0px)
            /* 45 is really 360 - 45 */
            rotate(270deg);
            width: 30px;
        }

            th.rotate > div > span {
                border-bottom: 0px solid #ccc;
                padding: 5px 10px;
            }

    .aft {
        display: none;
    }

    .aft-percent {
        display: none;
    }

    .table-bordered > thead > tr > th.extra-right {
        border-right: 3px solid #dddddd;
    }

    .table-bordered > thead > tr > td.extra-right {
        border-right: 3px solid #dddddd;
    }

    .table-bordered > tbody > tr > th.extra-right {
        border-right: 3px solid #dddddd;
    }

    .table-bordered > tbody > tr > td.extra-right {
        border-right: 3px solid #dddddd;
    }

    .table-bordered > tfoot > tr > th.extra-right {
        border-right: 3px solid #dddddd;
    }

    .table-bordered > tfoot > tr > td.extra-right {
        border-right: 3px solid #dddddd;
    }
</style>

@if (!Model.IsAssociateOnly)
{


<div class="jumbotron">
    <h1>After Sales Report for Associates</h1>
    <div class="row">
        <div class="col-sm-12">
            <h3>Select a Store and Date:</h3>
        </div>
    </div>
    @using (Html.BeginForm())
    {
        <div class="row">
            <div class="col-sm-12">
                <div class="row">
                    <div class="col-sm-3">
                        @Html.DropDownListFor(n => n.StoreId, new SelectList(SalesCommission.Business.Enums.Stores, "StoreId", "Name"), "- Select a Store -", new { @class = "form-control form-inline" })
                    </div>
                    @*<div class="col-sm-3">
            @Html.DropDownListFor(n => n.SelectedBrands, new MultiSelectList(SalesCommission.Business.Enums.Brands, "BrandId", "Name"), new { @class = "form-control form-inline chosen-select", multiple = "", data_placeholder = "Select Brands..." })
        </div>
    <div class="col-sm-2">
        @Html.DropDownListFor(n => n.ConditionId, new SelectList(SalesCommission.Business.Enums.Conditions, "ConditionId", "Name"), new { @class = "form-control form-inline" })
    </div>*@
                    <div class="col-sm-2">
                        @Html.DropDownListFor(n => n.MonthId, new SelectList(SalesCommission.Business.Enums.Months, "MonthId", "Name"), new { @class = "form-control form-inline" })
                    </div>
                    <div class="col-sm-2">
                        @Html.DropDownListFor(n => n.YearId, new SelectList(SalesCommission.Business.Enums.Years, "YearId", "Name"), new { @class = "form-control form-inline" })
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <input type="checkbox" name="chkIncludeHandyman" id="chkIncludeHandyman" @(Model.IncludeHandyman == true ? "checked" : "") /> <span style="font-size:14px;">Include Handyman Deals</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <input type="checkbox" name="chkIncludeDeals" id="chkIncludeDeals" @(Model.IncludeDeals == true ? "checked" : "") /> <span style="font-size:14px;">Include Deal Details</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <button class="btn btn-primary" type="submit" value="submit" name="Submit">Submit</button>
                    </div>
                </div>
            </div>

        </div>


    }

</div>
}
@if (Model.AftermarketDealGroups != null)
{
    var DescriptionName = Model.StoreId;

    if (Model.StoreId != null)
    {
        foreach (var store in SalesCommission.Business.Enums.Stores)
        {
            if (store.StoreId.ToLower() == Model.StoreId.ToLower())
            {
                DescriptionName = store.Name;
            }
        }
    }

    if(Model.IsAssociateOnly)
    {
        if(Model.AftermarketDealGroups[0] != null)
        {
            DescriptionName = Model.AftermarketDealGroups[0].AutoMall;
        }
    }

    <div class="row">
        <div class="col-md-12">
            <h3>After Sales Report for @Model.MonthId/@Model.YearId for @DescriptionName</h3>
        </div>
    </div>

    <div class="row">
        <div class="col-md-2">
            <input id="btnToggleAftermarketItems" type="button" value="Show Aftermarket Items" class="btn btn-primary" />
        </div>
        <div class="col-md-2">
            <input id="btnToggleAftermarketPercentage" type="button" value="Show Aftermarket Percentages" class="btn btn-primary" />
        </div>
    </div>
    <div class="row" style="margin-bottom:15px;">
        <table class="table table-bordered table-striped" style="font-size:12px;" id="section1">
            <thead>

                <tr style="background-color:#d9edf7;font-size:11px;">
                    <th class="text-center">Associate</th>
                    <th class="rotate"><div><span>Total Unit Count</span></div></th>

                    <th class="rotate"><div><span>After Sales Deal Count</span></div></th>
                    <th class="rotate"><div><span>After Sales Unit %</span></div></th>
                    <th class="rotate"><div><span>Avg Per After Sales Unit</span></div></th>
                    <th class="rotate"><div><span>Avg After Sale Per Total Unit</span></div></th>
                    <th class="rotate extra-right"><div><span>After Sales Gross Profit</span></div></th>
                    <th class="rotate aft"><div><span>Finance Income Count</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Finance Income %</span></div></th>
                    <th class="rotate aft"><div><span>Service Contract Count</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Service Contract %</span></div></th>
                    <th class="rotate aft"><div><span>Maintenance Contract Count</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Maintenance Contract %</span></div></th>
                    <th class="rotate aft"><div><span>GAP Count</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>GAP %</span></div></th>
                    <th class="rotate aft"><div><span>BPP/Loaner (MEMO)</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>BPP/Loaner %</span></div></th>

                    <th class="rotate"><div><span>Aftermarket Unit Count</span></div></th>
                    <th class="rotate"><div><span>Aftermarket Unit %</span></div></th>
                    @*<th class="rotate"><div><span>Avg Revenue Per AM Deal</span></div></th>
                        <th class="rotate"><div><span>Avg Cost Per AM Deal</span></div></th>*@
                    <th class="rotate"><div><span>Avg Gross Profit per AM Unit</span></div></th>
                    <th class="rotate"><div><span>Avg Gross Profit per Unit</span></div></th>
                    <th class="rotate"><div><span>Aftermarket Gross Profit</span></div></th>
                    <th class="rotate"><div><span>Total Gross Profit</span></div></th>
                    <th class="rotate"><div><span>Avg Gross Profit per Unit</span></div></th>
                    @*<th class="rotate"><div><span>Avg Vehicle Profit per Deal</span></div></th>*@

                    <th class="rotate aft"><div><span>Nitrogren</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Nitrogen %</span></div></th>
                    <th class="rotate aft"><div><span>ZurichShield</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>ZurichShield %</span></div></th>
                    <th class="rotate aft"><div><span>Select Protect</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Select Protect %</span></div></th>
                    <th class="rotate aft"><div><span>Tire and Wheel</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Tire and Wheel %</span></div></th>
                    <th class="rotate aft"><div><span>Key Replacement</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Key Replacement %</span></div></th>
                    <th class="rotate aft"><div><span>Windshield Protect</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Windshield Protect %</span></div></th>
                    <th class="rotate aft"><div><span>Wear & Tear</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Wear & Tear %</span></div></th>
                    <th class="rotate aft"><div><span>Secure Guard</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Secure Guard %</span></div></th>
                    <th class="rotate aft"><div><span>Fitzgerald Total Package</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Fitzgerald Total Package %</span></div></th>
                    <th class="rotate aft"><div><span>Rust Inhibitor/Undercoating</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Rust Inhibitor/Undercoating%</span></div></th>
                    <th class="rotate aft"><div><span>Undercoating</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Undercoating %</span></div></th>
                    <th class="rotate aft"><div><span>Rust Inhibitor</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Rust Inhibitor %</span></div></th>
                    <th class="rotate aft"><div><span>Data Dots</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Data Dots %</span></div></th>
                    <th class="rotate aft"><div><span>Paint and Dent Repair</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Paint and Dent Repair %</span></div></th>
                    <th class="rotate aft"><div><span>Misc 1</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Misc 1 %</span></div></th>
                    <th class="rotate aft"><div><span>Misc 2</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Misc 2 %</span></div></th>
                    <th class="rotate aft"><div><span>Misc 3</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Misc 3 %</span></div></th>
                    <th class="rotate aft"><div><span>Misc 4</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Misc 4 %</span></div></th>
                    <th class="rotate aft"><div><span>MD State Insp (MEMO)</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>MD State Insp %</span></div></th>
                    <th class="rotate aft"><div><span>Lease Fee (MEMO)</span></div></th>
                    <th class="rotate extra-right aft-percent"><div><span>Lease Fee %</span></div></th>

                </tr>
            </thead>
            <tbody>
                @{
                    decimal TotalBPPCount = 0;
                    decimal TotalNitrogenCount = 0;
                    decimal TotalZurichShieldCount = 0;
                    decimal TotalSelectProtectionCount = 0;
                    decimal TotalTireWheelCount = 0;
                    decimal TotalKeyReplacementCount = 0;
                    decimal TotalWindshieldProtectionCount = 0;
                    decimal TotalExcessWearTearCount = 0;
                    decimal TotalSecureGuardCount = 0;
                    decimal TotalFitzgeraldTotalPackageCount = 0;
                    decimal TotalRustInhibitorUndercoatingCount = 0;
                    decimal TotalUndercoatingCount = 0;
                    decimal TotalRustInhibitorCount = 0;
                    decimal TotalDataDotsCount = 0;
                    decimal TotalPaintlessCount = 0;
                    decimal TotalMisc1Count = 0;
                    decimal TotalLeaseFeeCount = 0;
                    decimal TotalMisc2Count = 0;
                    decimal TotalMisc3Count = 0;
                    decimal TotalMisc4Count = 0;
                    decimal TotalMDStateCount = 0;

                    decimal TotalFinanceCount = 0;
                    decimal TotalMaintenanceCount = 0;
                    decimal TotalServiceContractCount = 0;
                    decimal TotalGAPCount = 0;

                    double TotalBPPPercent = 0;
                    double TotalNitrogenPercent = 0;
                    double TotalZurichShieldPercent = 0;
                    double TotalSelectProtectionPercent = 0;
                    double TotalTireWheelPercent = 0;
                    double TotalKeyReplacementPercent = 0;
                    double TotalWindshieldProtectionPercent = 0;
                    double TotalExcessWearTearPercent = 0;
                    double TotalSecureGuardPercent = 0;
                    double TotalFitzgeraldTotalPackagePercent = 0;
                    double TotalRustInhibitorUndercoatingPercent = 0;
                    double TotalUndercoatingPercent = 0;
                    double TotalRustInhibitorPercent = 0;
                    double TotalDataDotsPercent = 0;
                    double TotalPaintlessPercent = 0;
                    double TotalMisc1Percent = 0;
                    double TotalLeaseFeePercent = 0;
                    double TotalMisc2Percent = 0;
                    double TotalMisc3Percent = 0;
                    double TotalMisc4Percent = 0;
                    double TotalMDStatePercent = 0;

                    double TotalFinancePercent = 0;
                    double TotalMaintenancePercent = 0;
                    double TotalServiceContractPercent = 0;
                    double TotalGAPPercent = 0;

                    decimal TotalDeals = 0;
                    decimal TotalAftermarketDeals = 0;
                    double TotalAftermarketPercent = 0;
                    decimal TotalAftermarketPrice = 0;
                    decimal TotalAftermarketCost = 0;
                    decimal TotalAftermarketProfit = 0;
                    decimal TotalVehicleProfit = 0;
                    decimal TotalOverallGrossProfit = 0;

                    double TotalAftermarketAvgPrice = 0;
                    double TotalAftermarketAvgCost = 0;
                    double TotalAftermarketAvgProfit = 0;
                    double TotalAftermarketTotalAvgProfit = 0;
                    double TotalVehicleAvgProfit = 0;

                    decimal TotalAfterSalesDeals = 0;
                    double TotalAfterSalesPercent = 0;
                    decimal TotalAfterSalesProfit = 0;

                    double TotalAfterSalesPerDeal = 0;
                    double TotalAfterSalesPerTotalDeals = 0;
                    double TotalAvgOverallGrossProfit = 0;

                    var index = 0;
                }


                @foreach (var dealGroup in Model.AftermarketDealGroups)
                {
                    index += 1;
                    decimal BPPCount = 0;
                    decimal NitrogenCount = 0;
                    decimal ZurichShieldCount = 0;
                    decimal SelectProtectionCount = 0;
                    decimal TireWheelCount = 0;
                    decimal KeyReplacementCount = 0;
                    decimal WindshieldProtectionCount = 0;
                    decimal ExcessWearTearCount = 0;
                    decimal SecureGuardCount = 0;
                    decimal FitzgeraldTotalPackageCount = 0;
                    decimal RustInhibitorUndercoatingCount = 0;
                    decimal UndercoatingCount = 0;
                    decimal RustInhibitorCount = 0;
                    decimal DataDotsCount = 0;
                    decimal PaintlessCount = 0;
                    decimal Misc1Count = 0;
                    decimal LeaseFeeCount = 0;
                    decimal Misc2Count = 0;
                    decimal Misc3Count = 0;
                    decimal Misc4Count = 0;
                    decimal MDStateCount = 0;
                    decimal FinanceCount = 0;
                    decimal ServiceContractCount = 0;
                    decimal MaintenanceCount = 0;
                    decimal GAPCount = 0;

                    decimal BPPUnitCount = 0;
                    decimal NitrogenUnitCount = 0;
                    decimal ZurichShieldUnitCount = 0;
                    decimal SelectProtectionUnitCount = 0;
                    decimal TireWheelUnitCount = 0;
                    decimal KeyReplacementUnitCount = 0;
                    decimal WindshieldProtectionUnitCount = 0;
                    decimal ExcessWearTearUnitCount = 0;
                    decimal SecureGuardUnitCount = 0;
                    decimal FitzgeraldTotalPackageUnitCount = 0;
                    decimal RustInhibitorUndercoatingUnitCount = 0;
                    decimal UndercoatingUnitCount = 0;
                    decimal RustInhibitorUnitCount = 0;
                    decimal DataDotsUnitCount = 0;
                    decimal PaintlessUnitCount = 0;
                    decimal Misc1UnitCount = 0;
                    decimal LeaseFeeUnitCount = 0;
                    decimal Misc2UnitCount = 0;
                    decimal Misc3UnitCount = 0;
                    decimal Misc4UnitCount = 0;
                    decimal MDStateUnitCount = 0;
                    decimal FinanceUnitCount = 0;
                    decimal ServiceContractUnitCount = 0;
                    decimal MaintenanceUnitCount = 0;
                    decimal GAPUnitCount = 0;

                    double FinancePercent = 0;
                    double ServiceContractPercent = 0;
                    double MaintenancePercent = 0;
                    double GAPPercent = 0;

                    double BPPPercent = 0;
                    double NitrogenPercent = 0;
                    double ZurichShieldPercent = 0;
                    double SelectProtectionPercent = 0;
                    double TireWheelPercent = 0;
                    double KeyReplacementPercent = 0;
                    double WindshieldProtectionPercent = 0;
                    double ExcessWearTearPercent = 0;
                    double SecureGuardPercent = 0;
                    double FitzgeraldTotalPackagePercent = 0;
                    double RustInhibitorUndercoatingPercent = 0;
                    double UndercoatingPercent = 0;
                    double RustInhibitorPercent = 0;
                    double DataDotsPercent = 0;
                    double PaintlessPercent = 0;
                    double Misc1Percent = 0;
                    double LeaseFeePercent = 0;
                    double Misc2Percent = 0;
                    double Misc3Percent = 0;
                    double Misc4Percent = 0;
                    double MDStatePercent = 0;

                    decimal AftermarketDealCount = 0;
                    decimal AftermarketDealUnitCount = 0;
                    double AftermarketPercent = 0;

                    decimal aftermarketPrice = 0;
                    decimal aftermarketCost = 0;
                    decimal aftermarketProfit = 0;
                    decimal vehicleProfit = 0;

                    double aftermarketAvgPrice = 0;
                    double aftermarketAvgCost = 0;
                    double aftermarketAvgProfit = 0;
                    double aftermarketTotalAvgProfit = 0;
                    double vehicleAvgProfit = 0;

                    decimal TotalGrossProfit = 0;

                    decimal afterSalesCount = 0;
                    decimal afterSalesUnitCount = 0;
                    double afterSalesPercent = 0;
                    decimal afterSalesAmount = 0;
                    double afterSalesAvgDeal = 0;
                    double afterSalesAvgOverallDeals = 0;
                    double TotalAvgGrossProfit = 0;

                    decimal TotalDealCount = 0;
                    decimal TotalUnitCount = 0;

                    foreach (var dealDetail in dealGroup.AftermarketDealDetails)
                    {

                        var dealValue = dealDetail.DealValue;

                        TotalUnitCount += dealValue;
                        TotalDealCount += 1;

                        BPPCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 1);// * dealValue;
                        NitrogenCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 2);// * dealValue;
                        ZurichShieldCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 3);// * dealValue;
                        SelectProtectionCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 4);// * dealValue;
                        TireWheelCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 5);// * dealValue;
                        KeyReplacementCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 6);// * dealValue;
                        WindshieldProtectionCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 7);// * dealValue;
                        ExcessWearTearCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 8);// * dealValue;
                        SecureGuardCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 9);// * dealValue;
                        FitzgeraldTotalPackageCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 10);// * dealValue;
                        RustInhibitorUndercoatingCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 11);// * dealValue;
                        UndercoatingCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 12);// * dealValue;
                        RustInhibitorCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 13);// * dealValue;
                        DataDotsCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 14);// * dealValue;
                        PaintlessCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 15);// * dealValue;
                        Misc1Count += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 16 && o.AftermarketName != "LEASE FEE");// * dealValue;
                        LeaseFeeCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 16 && o.AftermarketName == "LEASE FEE");// * dealValue;
                        Misc2Count += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 17);// * dealValue;
                        Misc3Count += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 18);// * dealValue;
                        Misc4Count += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 19);// * dealValue;
                        MDStateCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 20);// * dealValue;

                        BPPUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 1) * dealValue;
                        NitrogenUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 2) * dealValue;
                        ZurichShieldUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 3) * dealValue;
                        SelectProtectionUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 4) * dealValue;
                        TireWheelUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 5) * dealValue;
                        KeyReplacementUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 6) * dealValue;
                        WindshieldProtectionUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 7) * dealValue;
                        ExcessWearTearUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 8) * dealValue;
                        SecureGuardUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 9) * dealValue;
                        FitzgeraldTotalPackageUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 10) * dealValue;
                        RustInhibitorUndercoatingUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 11) * dealValue;
                        UndercoatingUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 12) * dealValue;
                        RustInhibitorUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 13) * dealValue;
                        DataDotsUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 14) * dealValue;
                        PaintlessUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 15) * dealValue;
                        Misc1UnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 16 && o.AftermarketName != "LEASE FEE") * dealValue;
                        LeaseFeeUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 16 && o.AftermarketName == "LEASE FEE") * dealValue;
                        Misc2UnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 17) * dealValue;
                        Misc3UnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 18) * dealValue;
                        Misc4UnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 19) * dealValue;
                        MDStateUnitCount += dealDetail.AftermarketItems.Count(o => o.AftermarketId == 20) * dealValue;

                        if (dealDetail.FinanceIncomeAmount > 0)
                        {
                            FinanceCount += 1;// dealValue;
                            FinanceUnitCount +=  dealValue;
                            afterSalesAmount += dealDetail.FinanceIncomeAmount * dealValue;
                        }
                        if (dealDetail.MaintenanceAmount > 0)
                        {
                            MaintenanceCount += 1;// dealValue;
                            MaintenanceUnitCount += dealValue;
                            afterSalesAmount += dealDetail.MaintenanceAmount * dealValue;
                        }
                        if (dealDetail.VSCAmount > 0)
                        {
                            ServiceContractCount += 1;// dealValue;
                            ServiceContractUnitCount +=  dealValue;
                            afterSalesAmount += dealDetail.VSCAmount * dealValue;
                        }
                        if (dealDetail.GAPAmount > 0)
                        {
                            GAPCount += 1;//dealValue;
                            GAPUnitCount += dealValue;
                            afterSalesAmount += dealDetail.GAPAmount * dealValue;
                        }

                        if ((dealDetail.FinanceIncomeAmount > 0) || (dealDetail.MaintenanceAmount > 0) || (dealDetail.VSCAmount > 0) || (dealDetail.GAPAmount > 0) ||  dealDetail.AftermarketItems.Count(o => o.AftermarketId == 1) > 0)
                        {
                            afterSalesCount += 1;//dealValue;
                            afterSalesUnitCount += dealValue;
                        }

                        vehicleProfit += (dealDetail.DealGrossAmount - dealDetail.BPPAmount - dealDetail.NitrogenAmount - dealDetail.ZurichAmount - dealDetail.TireWheelAmount - dealDetail.SecurityAmount - dealDetail.AdjustmentAmount - dealDetail.CertFeeAmount - dealDetail.OtherAmount);

                        if (dealDetail.AftermarketItems.Count > 0)
                        {
                            var BPPDeal = false;
                            var nonBPPDeal = false;
                            var MSIDeal = false;


                            foreach (var deal in dealDetail.AftermarketItems)
                            {
                                if (deal.AftermarketId != 1 && deal.AftermarketId != 20)
                                {
                                    if (deal.AftermarketId == 16 && deal.AftermarketName == "LEASE FEE")
                                    {
                                        //DO NOT ADD TO THE TOTALS
                                    }
                                    else
                                    {
                                        aftermarketPrice += deal.AftermarketPrice;
                                        aftermarketCost += deal.AftermarketCost;
                                        aftermarketProfit += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                    }
                                    nonBPPDeal = true;
                                }
                                else if (deal.AftermarketId == 1)
                                {
                                    afterSalesAmount += deal.AftermarketPrice * dealValue;
                                    BPPDeal = true;
                                }
                                else if (deal.AftermarketId == 20)
                                {
                                    MSIDeal = true;
                                }
                            }

                            if (nonBPPDeal)
                            {
                                //This is a nonBPP and nonMSI Deal, increment count
                                AftermarketDealCount += 1;//dealValue;
                                AftermarketDealUnitCount += dealValue;
                            }

                        }
                    }

                    FinancePercent = (double)FinanceCount / (double)TotalDealCount;
                    ServiceContractPercent = (double)ServiceContractCount / (double)TotalDealCount;
                    MaintenancePercent = (double)MaintenanceCount / (double)TotalDealCount;
                    GAPPercent = (double)GAPCount / (double)TotalDealCount;

                    BPPPercent = (double)BPPCount / (double)TotalDealCount;
                    NitrogenPercent = (double)NitrogenCount / (double)TotalDealCount;
                    ZurichShieldPercent = (double)ZurichShieldCount / (double)TotalDealCount;
                    SelectProtectionPercent = (double)SelectProtectionCount / (double)TotalDealCount;
                    TireWheelPercent = (double)TireWheelCount / (double)TotalDealCount;
                    KeyReplacementPercent = (double)KeyReplacementCount / (double)TotalDealCount;
                    WindshieldProtectionPercent = (double)WindshieldProtectionCount / (double)TotalDealCount;
                    ExcessWearTearPercent = (double)ExcessWearTearCount / (double)TotalDealCount;
                    SecureGuardPercent = (double)SecureGuardCount / (double)TotalDealCount;
                    FitzgeraldTotalPackagePercent = (double)FitzgeraldTotalPackageCount / (double)TotalDealCount;
                    RustInhibitorUndercoatingPercent = (double)RustInhibitorUndercoatingCount / (double)TotalDealCount;
                    UndercoatingPercent = (double)UndercoatingCount / (double)TotalDealCount;
                    RustInhibitorPercent = (double)RustInhibitorCount / (double)TotalDealCount;
                    DataDotsPercent = (double)DataDotsCount / (double)TotalDealCount;
                    PaintlessPercent = (double)PaintlessCount / (double)TotalDealCount;
                    Misc1Percent = (double)Misc1Count / (double)TotalDealCount;
                    LeaseFeePercent = (double)LeaseFeeCount / (double)TotalDealCount;
                    Misc2Percent = (double)Misc2Count / (double)TotalDealCount;
                    Misc3Percent = (double)Misc3Count / (double)TotalDealCount;
                    Misc4Percent = (double)Misc4Count / (double)TotalDealCount;
                    MDStatePercent = (double)MDStateCount / (double)TotalDealCount;

                    if (AftermarketDealCount > 0)
                    {
                        aftermarketAvgPrice = (double)aftermarketPrice / (double)AftermarketDealCount;
                        aftermarketAvgCost = (double)aftermarketCost / (double)AftermarketDealCount;
                        aftermarketAvgProfit = (double)aftermarketProfit / (double)AftermarketDealCount;
                    }
                    aftermarketTotalAvgProfit = (double)aftermarketProfit / (double)TotalDealCount;

                    vehicleAvgProfit = (double)vehicleProfit / (double)TotalDealCount;

                    AftermarketPercent = (double)AftermarketDealCount / (double)TotalDealCount;

                    afterSalesPercent = (double)afterSalesCount / (double)TotalDealCount;
                    afterSalesAvgDeal = (double)afterSalesAmount / (double)afterSalesCount;
                    afterSalesAvgOverallDeals = (double)afterSalesAmount / (double)TotalDealCount;

                    TotalGrossProfit = afterSalesAmount + aftermarketProfit;

                    TotalAvgGrossProfit = (double)TotalGrossProfit / (double)TotalDealCount;




                    <tr>
                        @if (Model.IncludeDeals)
                        {
                            <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index">@dealGroup.AutoMall <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                        }
                        else
                        {
                            <td class="text-center">@dealGroup.AutoMall</td>
                        }

                        <td class="text-center">@TotalUnitCount</td>

                        <td class="text-center">@afterSalesCount</td>
                        <td class="text-center">@afterSalesPercent.ToString("P", nfi)</td>
                        <td class="text-center">@afterSalesAvgDeal.ToString("C", nfi)</td>
                        <td class="text-center">@afterSalesAvgOverallDeals.ToString("C", nfi)</td>
                        <td class="text-center extra-right">@afterSalesAmount.ToString("C", nfi)</td>
                        <td class="text-center aft">@FinanceCount</td>
                        <td class="text-center extra-right aft-percent">@FinancePercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@ServiceContractCount</td>
                        <td class="text-center extra-right aft-percent">@ServiceContractPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@MaintenanceCount</td>
                        <td class="text-center extra-right aft-percent">@MaintenancePercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@GAPCount</td>
                        <td class="text-center extra-right aft-percent">@GAPPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@BPPCount</td>
                        <td class="text-center extra-right aft-percent">@BPPPercent.ToString("P", nfi)</td>
                        <td class="text-center">@AftermarketDealCount</td>
                        <td class="text-center">@AftermarketPercent.ToString("P", nfi)</td>
                        @*<td class="text-center">@aftermarketAvgPrice.ToString("C", nfi)</td>
                            <td class="text-center">@aftermarketAvgCost.ToString("C", nfi)</td>*@
                        <td class="text-center">@aftermarketAvgProfit.ToString("C", nfi)</td>
                        <td class="text-center">@aftermarketTotalAvgProfit.ToString("C", nfi)</td>
                        <td class="text-center">@aftermarketProfit.ToString("C", nfi)</td>
                        <td class="text-center">@TotalGrossProfit.ToString("C", nfi)</td>
                        <td class="text-center">@TotalAvgGrossProfit.ToString("C", nfi)</td>
                        @*<td class="text-center">@vehicleAvgProfit.ToString("C", nfi)</td>*@
                        @*<td class="text-center extra-right">@aftermarketAvgProfit.ToString("C", nfi)</td>*@


                        <td class="text-center aft">@NitrogenCount</td>
                        <td class="text-center extra-right aft-percent">@NitrogenPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@ZurichShieldCount</td>
                        <td class="text-center extra-right aft-percent">@ZurichShieldPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@SelectProtectionCount</td>
                        <td class="text-center extra-right aft-percent">@SelectProtectionPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@TireWheelCount</td>
                        <td class="text-center extra-right aft-percent">@TireWheelPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@KeyReplacementCount</td>
                        <td class="text-center extra-right aft-percent">@KeyReplacementPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@WindshieldProtectionCount</td>
                        <td class="text-center extra-right aft-percent">@WindshieldProtectionPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@ExcessWearTearCount</td>
                        <td class="text-center extra-right aft-percent">@ExcessWearTearPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@SecureGuardCount</td>
                        <td class="text-center extra-right aft-percent">@SecureGuardPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@FitzgeraldTotalPackageCount</td>
                        <td class="text-center extra-right aft-percent">@FitzgeraldTotalPackagePercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@RustInhibitorUndercoatingCount</td>
                        <td class="text-center extra-right aft-percent">@RustInhibitorUndercoatingPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@UndercoatingCount</td>
                        <td class="text-center extra-right aft-percent">@UndercoatingPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@RustInhibitorCount</td>
                        <td class="text-center extra-right aft-percent">@RustInhibitorPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@DataDotsCount</td>
                        <td class="text-center extra-right aft-percent">@DataDotsPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@PaintlessCount</td>
                        <td class="text-center extra-right aft-percent">@PaintlessPercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@Misc1Count</td>
                        <td class="text-center extra-right aft-percent">@Misc1Percent.ToString("P", nfi)</td>
                        <td class="text-center aft">@Misc2Count</td>
                        <td class="text-center extra-right aft-percent">@Misc2Percent.ToString("P", nfi)</td>
                        <td class="text-center aft">@Misc3Count</td>
                        <td class="text-center extra-right aft-percent">@Misc3Percent.ToString("P", nfi)</td>
                        <td class="text-center aft">@Misc4Count</td>
                        <td class="text-center extra-right aft-percent">@Misc4Percent.ToString("P", nfi)</td>
                        <td class="text-center aft">@MDStateCount</td>
                        <td class="text-center extra-right aft-percent">@MDStatePercent.ToString("P", nfi)</td>
                        <td class="text-center aft">@LeaseFeeCount</td>
                        <td class="text-center extra-right aft-percent">@LeaseFeePercent.ToString("P", nfi)</td>
                    </tr>

                    if (Model.IncludeDeals)
                    {
                        <tr id="collapse-@index" class="collapse out" style="background-color:lightgray">
                            <td colspan="22">
                                <h5>@dealGroup.AutoMall After Sales</h5>
                                <table class="table table-bordered table-striped" style="font-size:12px;">
                                    <thead>
                                        <tr>
                                            <th class="text-center">After Sales Metric</th>
                                            <th class="text-center">Total Unit Count</th>
                                            <th class="text-center">Item Unit Count</th>
                                            <th class="text-center">Item Unit %</th>
                                            <th class="text-center">Item Amount Per Deal</th>
                                            <th class="text-center">Item Amount per Total Units</th>
                                            <th class="text-center">Item Total Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{
                                            decimal totalPrice1 = 0;
                                            decimal totalCost1 = 0;
                                            decimal totalProfit1 = 0;

                                            decimal totalPrice2 = 0;
                                            decimal totalCost2 = 0;
                                            decimal totalProfit2 = 0;

                                            decimal totalPrice3 = 0;
                                            decimal totalCost3 = 0;
                                            decimal totalProfit3 = 0;

                                            decimal totalPrice4 = 0;
                                            decimal totalCost4 = 0;
                                            decimal totalProfit4 = 0;

                                            decimal totalPrice5 = 0;
                                            decimal totalCost5 = 0;
                                            decimal totalProfit5 = 0;

                                            decimal totalPrice6 = 0;
                                            decimal totalCost6 = 0;
                                            decimal totalProfit6 = 0;

                                            decimal totalPrice7 = 0;
                                            decimal totalCost7 = 0;
                                            decimal totalProfit7 = 0;

                                            decimal totalPrice8 = 0;
                                            decimal totalCost8 = 0;
                                            decimal totalProfit8 = 0;

                                            decimal totalPrice9 = 0;
                                            decimal totalCost9 = 0;
                                            decimal totalProfit9 = 0;

                                            decimal totalPrice10 = 0;
                                            decimal totalCost10 = 0;
                                            decimal totalProfit10 = 0;

                                            decimal totalPrice11 = 0;
                                            decimal totalCost11 = 0;
                                            decimal totalProfit11 = 0;

                                            decimal totalPrice12 = 0;
                                            decimal totalCost12 = 0;
                                            decimal totalProfit12 = 0;

                                            decimal totalPrice13 = 0;
                                            decimal totalCost13 = 0;
                                            decimal totalProfit13 = 0;

                                            decimal totalPrice14 = 0;
                                            decimal totalCost14 = 0;
                                            decimal totalProfit14 = 0;

                                            decimal totalPrice15 = 0;
                                            decimal totalCost15 = 0;
                                            decimal totalProfit15 = 0;

                                            decimal totalPrice16 = 0;
                                            decimal totalCost16 = 0;
                                            decimal totalProfit16 = 0;

                                            decimal totalPrice17 = 0;
                                            decimal totalCost17 = 0;
                                            decimal totalProfit17 = 0;

                                            decimal totalPrice18 = 0;
                                            decimal totalCost18 = 0;
                                            decimal totalProfit18 = 0;

                                            decimal totalPrice19 = 0;
                                            decimal totalCost19 = 0;
                                            decimal totalProfit19 = 0;

                                            decimal totalPrice20 = 0;
                                            decimal totalCost20 = 0;
                                            decimal totalProfit20 = 0;

                                            decimal totalPrice21 = 0;
                                            decimal totalCost21 = 0;
                                            decimal totalProfit21 = 0;

                                            double totalAvgPrice1 = 0;
                                            double totalAvgCost1 = 0;
                                            double totalAvgProfit1 = 0;
                                            double totalOverallAvgProfit1 = 0;

                                            double totalAvgPrice2 = 0;
                                            double totalAvgCost2 = 0;
                                            double totalAvgProfit2 = 0;
                                            double totalOverallAvgProfit2 = 0;

                                            double totalAvgPrice3 = 0;
                                            double totalAvgCost3 = 0;
                                            double totalAvgProfit3 = 0;
                                            double totalOverallAvgProfit3 = 0;

                                            double totalAvgPrice4 = 0;
                                            double totalAvgCost4 = 0;
                                            double totalAvgProfit4 = 0;
                                            double totalOverallAvgProfit4 = 0;

                                            double totalAvgPrice5 = 0;
                                            double totalAvgCost5 = 0;
                                            double totalAvgProfit5 = 0;
                                            double totalOverallAvgProfit5 = 0;

                                            double totalAvgPrice6 = 0;
                                            double totalAvgCost6 = 0;
                                            double totalAvgProfit6 = 0;
                                            double totalOverallAvgProfit6 = 0;

                                            double totalAvgPrice7 = 0;
                                            double totalAvgCost7 = 0;
                                            double totalAvgProfit7 = 0;
                                            double totalOverallAvgProfit7 = 0;

                                            double totalAvgPrice8 = 0;
                                            double totalAvgCost8 = 0;
                                            double totalAvgProfit8 = 0;
                                            double totalOverallAvgProfit8 = 0;

                                            double totalAvgPrice9 = 0;
                                            double totalAvgCost9 = 0;
                                            double totalAvgProfit9 = 0;
                                            double totalOverallAvgProfit9 = 0;

                                            double totalAvgPrice10 = 0;
                                            double totalAvgCost10 = 0;
                                            double totalAvgProfit10 = 0;
                                            double totalOverallAvgProfit10 = 0;

                                            double totalAvgPrice11 = 0;
                                            double totalAvgCost11 = 0;
                                            double totalAvgProfit11 = 0;
                                            double totalOverallAvgProfit11 = 0;

                                            double totalAvgPrice12 = 0;
                                            double totalAvgCost12 = 0;
                                            double totalAvgProfit12 = 0;
                                            double totalOverallAvgProfit12 = 0;

                                            double totalAvgPrice13 = 0;
                                            double totalAvgCost13 = 0;
                                            double totalAvgProfit13 = 0;
                                            double totalOverallAvgProfit13 = 0;

                                            double totalAvgPrice14 = 0;
                                            double totalAvgCost14 = 0;
                                            double totalAvgProfit14 = 0;
                                            double totalOverallAvgProfit14 = 0;

                                            double totalAvgPrice15 = 0;
                                            double totalAvgCost15 = 0;
                                            double totalAvgProfit15 = 0;
                                            double totalOverallAvgProfit15 = 0;

                                            double totalAvgPrice16 = 0;
                                            double totalAvgCost16 = 0;
                                            double totalAvgProfit16 = 0;
                                            double totalOverallAvgProfit16 = 0;

                                            double totalAvgPrice17 = 0;
                                            double totalAvgCost17 = 0;
                                            double totalAvgProfit17 = 0;
                                            double totalOverallAvgProfit17 = 0;

                                            double totalAvgPrice18 = 0;
                                            double totalAvgCost18 = 0;
                                            double totalAvgProfit18 = 0;
                                            double totalOverallAvgProfit18 = 0;

                                            double totalAvgPrice19 = 0;
                                            double totalAvgCost19 = 0;
                                            double totalAvgProfit19 = 0;
                                            double totalOverallAvgProfit19 = 0;

                                            double totalAvgPrice20 = 0;
                                            double totalAvgCost20 = 0;
                                            double totalAvgProfit20 = 0;
                                            double totalOverallAvgProfit20 = 0;

                                            double totalAvgPrice21 = 0;
                                            double totalAvgCost21 = 0;
                                            double totalAvgProfit21 = 0;
                                            double totalOverallAvgProfit21 = 0;

                                            double totalFincanceAvgAmount = 0;
                                            double totalOverallFinanceAvgAmount = 0;
                                            double totalServiceAvgAmount = 0;
                                            double totalOverallServiceAvgAmount = 0;
                                            double totalMaintenanceAvgAmount = 0;
                                            double totalOverallMaintenanceAvgAmount = 0;
                                            double totalGAPAvgAmount = 0;
                                            double totalOverallGAPAvgAmount = 0;

                                            decimal FinanceAmount = 0;
                                            decimal ServiceContractAmount = 0;
                                            decimal MaintenanceContractAmount = 0;
                                            decimal GAPAmount = 0;



                                            foreach (var dealDetail in dealGroup.AftermarketDealDetails)
                                            {

                                                var dealValue = dealDetail.DealValue;

                                                FinanceAmount += dealDetail.FinanceIncomeAmount * dealValue;
                                                MaintenanceContractAmount += dealDetail.MaintenanceAmount * dealValue;
                                                ServiceContractAmount += dealDetail.VSCAmount * dealValue;
                                                GAPAmount += dealDetail.GAPAmount * dealValue;

                                                if (dealDetail.AftermarketItems.Count > 0)
                                                {

                                                    foreach (var deal in dealDetail.AftermarketItems)
                                                    {
                                                        if (deal.AftermarketId == 1)
                                                        {
                                                            totalPrice1 += deal.AftermarketPrice;
                                                            totalCost1 += deal.AftermarketCost;
                                                            totalProfit1 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 2)
                                                        {
                                                            totalPrice2 += deal.AftermarketPrice;
                                                            totalCost2 += deal.AftermarketCost;
                                                            totalProfit2 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 3)
                                                        {
                                                            totalPrice3 += deal.AftermarketPrice;
                                                            totalCost3 += deal.AftermarketCost;
                                                            totalProfit3 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 4)
                                                        {
                                                            totalPrice4 += deal.AftermarketPrice;
                                                            totalCost4 += deal.AftermarketCost;
                                                            totalProfit4 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 5)
                                                        {
                                                            totalPrice5 += deal.AftermarketPrice;
                                                            totalCost5 += deal.AftermarketCost;
                                                            totalProfit5 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 6)
                                                        {
                                                            totalPrice6 += deal.AftermarketPrice;
                                                            totalCost6 += deal.AftermarketCost;
                                                            totalProfit6 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 7)
                                                        {
                                                            totalPrice7 += deal.AftermarketPrice;
                                                            totalCost7 += deal.AftermarketCost;
                                                            totalProfit7 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 8)
                                                        {
                                                            totalPrice8 += deal.AftermarketPrice;
                                                            totalCost8 += deal.AftermarketCost;
                                                            totalProfit8 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 9)
                                                        {
                                                            totalPrice9 += deal.AftermarketPrice;
                                                            totalCost9 += deal.AftermarketCost;
                                                            totalProfit9 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }

                                                        if (deal.AftermarketId == 10)
                                                        {
                                                            totalPrice10 += deal.AftermarketPrice;
                                                            totalCost10 += deal.AftermarketCost;
                                                            totalProfit10 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 11)
                                                        {
                                                            totalPrice11 += deal.AftermarketPrice;
                                                            totalCost11 += deal.AftermarketCost;
                                                            totalProfit11 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 12)
                                                        {
                                                            totalPrice12 += deal.AftermarketPrice;
                                                            totalCost12 += deal.AftermarketCost;
                                                            totalProfit12 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 13)
                                                        {
                                                            totalPrice13 += deal.AftermarketPrice;
                                                            totalCost13 += deal.AftermarketCost;
                                                            totalProfit13 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 14)
                                                        {
                                                            totalPrice14 += deal.AftermarketPrice;
                                                            totalCost14 += deal.AftermarketCost;
                                                            totalProfit14 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 15)
                                                        {
                                                            totalPrice15 += deal.AftermarketPrice;
                                                            totalCost15 += deal.AftermarketCost;
                                                            totalProfit15 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 16 && deal.AftermarketName != "LEASE FEE")
                                                        {
                                                            totalPrice16 += deal.AftermarketPrice;
                                                            totalCost16 += deal.AftermarketCost;
                                                            totalProfit16 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 16 && deal.AftermarketName == "LEASE FEE")
                                                        {
                                                            totalPrice21 += deal.AftermarketPrice;
                                                            totalCost21 += deal.AftermarketCost;
                                                            totalProfit21 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }

                                                        if (deal.AftermarketId == 17)
                                                        {
                                                            totalPrice17 += deal.AftermarketPrice;
                                                            totalCost17 += deal.AftermarketCost;
                                                            totalProfit17 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 18)
                                                        {
                                                            totalPrice18 += deal.AftermarketPrice;
                                                            totalCost18 += deal.AftermarketCost;
                                                            totalProfit18 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                        if (deal.AftermarketId == 19)
                                                        {
                                                            totalPrice19 += deal.AftermarketPrice;
                                                            totalCost19 += deal.AftermarketCost;
                                                            totalProfit19 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }

                                                        if (deal.AftermarketId == 20)
                                                        {
                                                            totalPrice20 += deal.AftermarketPrice;
                                                            totalCost20 += deal.AftermarketCost;
                                                            totalProfit20 += (deal.AftermarketPrice - deal.AftermarketCost) * dealValue;
                                                        }
                                                    }

                                                }
                                            }


                                            if (BPPCount > 0)
                                            {
                                                totalAvgPrice1 = (double)totalPrice1 / (double)BPPCount;
                                                totalAvgCost1 = (double)totalCost1 / (double)BPPCount;
                                                totalAvgProfit1 = (double)totalProfit1 / (double)BPPCount;
                                            }
                                            totalOverallAvgProfit1 = (double)totalProfit1 / (double)TotalDealCount;

                                            if (NitrogenCount > 0)
                                            {
                                                totalAvgPrice2 = (double)totalPrice2 / (double)NitrogenCount;
                                                totalAvgCost2 = (double)totalCost2 / (double)NitrogenCount;
                                                totalAvgProfit2 = (double)totalProfit2 / (double)NitrogenCount;
                                            }
                                            totalOverallAvgProfit2 = (double)totalProfit2 / (double)TotalDealCount;

                                            if (ZurichShieldCount > 0)
                                            {
                                                totalAvgPrice3 = (double)totalPrice3 / (double)ZurichShieldCount;
                                                totalAvgCost3 = (double)totalCost3 / (double)ZurichShieldCount;
                                                totalAvgProfit3 = (double)totalProfit3 / (double)ZurichShieldCount;
                                            }
                                            totalOverallAvgProfit3 = (double)totalProfit3 / (double)TotalDealCount;

                                            if (SelectProtectionCount > 0)
                                            {
                                                totalAvgPrice4 = (double)totalPrice4 / (double)SelectProtectionCount;
                                                totalAvgCost4 = (double)totalCost4 / (double)SelectProtectionCount;
                                                totalAvgProfit4 = (double)totalProfit4 / (double)SelectProtectionCount;
                                            }
                                            totalOverallAvgProfit4 = (double)totalProfit4 / (double)TotalDealCount;

                                            if (TireWheelCount > 0)
                                            {
                                                totalAvgPrice5 = (double)totalPrice5 / (double)TireWheelCount;
                                                totalAvgCost5 = (double)totalCost5 / (double)TireWheelCount;
                                                totalAvgProfit5 = (double)totalProfit5 / (double)TireWheelCount;
                                            }
                                            totalOverallAvgProfit5 = (double)totalProfit5 / (double)TotalDealCount;

                                            if (KeyReplacementCount > 0)
                                            {
                                                totalAvgPrice6 = (double)totalPrice6 / (double)KeyReplacementCount;
                                                totalAvgCost6 = (double)totalCost6 / (double)KeyReplacementCount;
                                                totalAvgProfit6 = (double)totalProfit6 / (double)KeyReplacementCount;
                                            }
                                            totalOverallAvgProfit6 = (double)totalProfit6 / (double)TotalDealCount;

                                            if (WindshieldProtectionCount > 0)
                                            {
                                                totalAvgPrice7 = (double)totalPrice7 / (double)WindshieldProtectionCount;
                                                totalAvgCost7 = (double)totalCost7 / (double)WindshieldProtectionCount;
                                                totalAvgProfit7 = (double)totalProfit7 / (double)WindshieldProtectionCount;
                                            }
                                            totalOverallAvgProfit7 = (double)totalProfit7 / (double)TotalDealCount;

                                            if (ExcessWearTearCount > 0)
                                            {
                                                totalAvgPrice8 = (double)totalPrice8 / (double)ExcessWearTearCount;
                                                totalAvgCost8 = (double)totalCost8 / (double)ExcessWearTearCount;
                                                totalAvgProfit8 = (double)totalProfit8 / (double)ExcessWearTearCount;
                                            }
                                            totalOverallAvgProfit8 = (double)totalProfit8 / (double)TotalDealCount;

                                            if (SecureGuardCount > 0)
                                            {
                                                totalAvgPrice9 = (double)totalPrice9 / (double)SecureGuardCount;
                                                totalAvgCost9 = (double)totalCost9 / (double)SecureGuardCount;
                                                totalAvgProfit9 = (double)totalProfit9 / (double)SecureGuardCount;
                                            }
                                            totalOverallAvgProfit9 = (double)totalProfit9 / (double)TotalDealCount;

                                            if (FitzgeraldTotalPackageCount > 0)
                                            {
                                                totalAvgPrice10 = (double)totalPrice10 / (double)FitzgeraldTotalPackageCount;
                                                totalAvgCost10 = (double)totalCost10 / (double)FitzgeraldTotalPackageCount;
                                                totalAvgProfit10 = (double)totalProfit10 / (double)FitzgeraldTotalPackageCount;
                                            }
                                            totalOverallAvgProfit10 = (double)totalProfit10 / (double)TotalDealCount;

                                            if (RustInhibitorUndercoatingCount > 0)
                                            {
                                                totalAvgPrice11 = (double)totalPrice11 / (double)RustInhibitorUndercoatingCount;
                                                totalAvgCost11 = (double)totalCost11 / (double)RustInhibitorUndercoatingCount;
                                                totalAvgProfit11 = (double)totalProfit11 / (double)RustInhibitorUndercoatingCount;
                                            }
                                            totalOverallAvgProfit11 = (double)totalProfit11 / (double)TotalDealCount;

                                            if (UndercoatingCount > 0)
                                            {
                                                totalAvgPrice12 = (double)totalPrice12 / (double)UndercoatingCount;
                                                totalAvgCost12 = (double)totalCost12 / (double)UndercoatingCount;
                                                totalAvgProfit12 = (double)totalProfit12 / (double)UndercoatingCount;
                                            }
                                            totalOverallAvgProfit12 = (double)totalProfit12 / (double)TotalDealCount;

                                            if (RustInhibitorCount > 0)
                                            {
                                                totalAvgPrice13 = (double)totalPrice13 / (double)RustInhibitorCount;
                                                totalAvgCost13 = (double)totalCost13 / (double)RustInhibitorCount;
                                                totalAvgProfit13 = (double)totalProfit13 / (double)RustInhibitorCount;
                                            }
                                            totalOverallAvgProfit13 = (double)totalProfit13 / (double)TotalDealCount;

                                            if (DataDotsCount > 0)
                                            {
                                                totalAvgPrice14 = (double)totalPrice14 / (double)DataDotsCount;
                                                totalAvgCost14 = (double)totalCost14 / (double)DataDotsCount;
                                                totalAvgProfit14 = (double)totalProfit14 / (double)DataDotsCount;
                                            }
                                            totalOverallAvgProfit14 = (double)totalProfit14 / (double)TotalDealCount;

                                            if (PaintlessCount > 0)
                                            {
                                                totalAvgPrice15 = (double)totalPrice15 / (double)PaintlessCount;
                                                totalAvgCost15 = (double)totalCost15 / (double)PaintlessCount;
                                                totalAvgProfit15 = (double)totalProfit15 / (double)PaintlessCount;
                                            }
                                            totalOverallAvgProfit15 = (double)totalProfit15 / (double)TotalDealCount;

                                            if (Misc1Count > 0)
                                            {
                                                totalAvgPrice16 = (double)totalPrice16 / (double)Misc1Count;
                                                totalAvgCost16 = (double)totalCost16 / (double)Misc1Count;
                                                totalAvgProfit16 = (double)totalProfit16 / (double)Misc1Count;
                                            }
                                            totalOverallAvgProfit16 = (double)totalProfit16 / (double)TotalDealCount;

                                            if (Misc2Count > 0)
                                            {
                                                totalAvgPrice17 = (double)totalPrice17 / (double)Misc2Count;
                                                totalAvgCost17 = (double)totalCost17 / (double)Misc2Count;
                                                totalAvgProfit17 = (double)totalProfit17 / (double)Misc2Count;
                                            }
                                            totalOverallAvgProfit17 = (double)totalProfit17 / (double)TotalDealCount;

                                            if (Misc3Count > 0)
                                            {
                                                totalAvgPrice18 = (double)totalPrice18 / (double)Misc3Count;
                                                totalAvgCost18 = (double)totalCost18 / (double)Misc3Count;
                                                totalAvgProfit18 = (double)totalProfit18 / (double)Misc3Count;
                                            }
                                            totalOverallAvgProfit18 = (double)totalProfit18 / (double)TotalDealCount;

                                            if (Misc4Count > 0)
                                            {
                                                totalAvgPrice19 = (double)totalPrice19 / (double)Misc4Count;
                                                totalAvgCost19 = (double)totalCost19 / (double)Misc4Count;
                                                totalAvgProfit19 = (double)totalProfit19 / (double)Misc4Count;
                                            }
                                            totalOverallAvgProfit19 = (double)totalProfit19 / (double)TotalDealCount;

                                            if (MDStateCount > 0)
                                            {
                                                totalAvgPrice20 = (double)totalPrice20 / (double)MDStateCount;
                                                totalAvgCost20 = (double)totalCost20 / (double)MDStateCount;
                                                totalAvgProfit20 = (double)totalProfit20 / (double)MDStateCount;
                                            }
                                            totalOverallAvgProfit20 = (double)totalProfit20 / (double)TotalDealCount;

                                            if (LeaseFeeCount > 0)
                                            {
                                                totalAvgPrice21 = (double)totalPrice21 / (double)LeaseFeeCount;
                                                totalAvgCost21 = (double)totalCost21 / (double)LeaseFeeCount;
                                                totalAvgProfit21 = (double)totalProfit21 / (double)LeaseFeeCount;
                                            }
                                            totalOverallAvgProfit16 = (double)totalProfit16 / (double)TotalDealCount;



                                            if (FinanceCount > 0)
                                            {
                                                totalFincanceAvgAmount = (double)FinanceAmount / (double)Math.Round(FinanceCount,MidpointRounding.AwayFromZero);
                                                totalOverallFinanceAvgAmount = (double)FinanceAmount / (double)TotalDealCount;
                                            }

                                            if (ServiceContractCount > 0)
                                            {
                                                totalServiceAvgAmount = (double)ServiceContractAmount / (double)Math.Round(ServiceContractCount, MidpointRounding.AwayFromZero);
                                                totalOverallServiceAvgAmount = (double)ServiceContractAmount / (double)TotalDealCount;
                                            }

                                            if (MaintenanceCount > 0)
                                            {
                                                totalMaintenanceAvgAmount = (double)MaintenanceContractAmount / (double)Math.Round(MaintenanceCount, MidpointRounding.AwayFromZero);
                                                totalOverallMaintenanceAvgAmount = (double)MaintenanceContractAmount / (double)TotalDealCount;
                                            }

                                            if (GAPCount > 0)
                                            {
                                                totalGAPAvgAmount = (double)GAPAmount / (double)Math.Round(GAPCount, MidpointRounding.AwayFromZero);
                                                totalOverallGAPAvgAmount = (double)GAPAmount / (double)TotalDealCount;
                                            }
                                                        }

                                                        @if (FinanceCount > -1)
                                        {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-fi">Finance Income <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@FinanceUnitCount</td>
                                                <td class="text-center">@FinancePercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalFincanceAvgAmount.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallFinanceAvgAmount.ToString("C", nfi)</td>
                                                <td class="text-center">@FinanceAmount.ToString("C", nfi)</td>

                                            </tr>
                                                    <tr id="collapse-@index-fi" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Finance Income Amount</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                                {
                                                    if (deal.FinanceIncomeAmount > 0)
                                                    {
                                                        aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.FinanceIncomeAmount.ToString("C", nfi)</td>
                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>                                                }
                                        @if (ServiceContractCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-sc">Service Contract <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@ServiceContractUnitCount</td>
                                                <td class="text-center">@ServiceContractPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalServiceAvgAmount.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallServiceAvgAmount.ToString("C", nfi)</td>
                                                <td class="text-center">@ServiceContractAmount.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-sc" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Service Contract Amount</th>

                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.VSCAmount > 0)
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.VSCAmount.ToString("C", nfi)</td>
                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (MaintenanceCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-mc">Maintenance Contract <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@MaintenanceUnitCount</td>
                                                <td class="text-center">@MaintenancePercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalMaintenanceAvgAmount.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallMaintenanceAvgAmount.ToString("C", nfi)</td>
                                                <td class="text-center">@MaintenanceContractAmount.ToString("C", nfi)</td>

                                            </tr>
                                                    <tr id="collapse-@index-mc" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Maintenance Amount</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                var aftermarketDealIndex = 0;
                                            }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.MaintenanceAmount > 0)
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.MaintenanceAmount.ToString("C", nfi)</td>
                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (GAPCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-gp">GAP <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@GAPUnitCount</td>
                                                <td class="text-center">@GAPPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalGAPAvgAmount.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallGAPAvgAmount.ToString("C", nfi)</td>
                                                <td class="text-center">@GAPAmount.ToString("C", nfi)</td>

                                            </tr>
                                                    <tr id="collapse-@index-gp" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">GAP Amount</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                var aftermarketDealIndex = 0;
                                            }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.GAPAmount > 0)
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.GAPAmount.ToString("C", nfi)</td>
                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>

                                                                        }
                                        @if (BPPCount > -1)
                                            {

                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-1">BPP/Loaner <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@BPPUnitCount</td>
                                                <td class="text-center">@BPPPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgProfit1.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit1.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit1.ToString("C", nfi)</td>
                                            </tr>
                                            <tr id="collapse-@index-1" class="collapse out" style="background-color:#f5f5f5">
                                                <td colspan="11">
                                                    <table class="table table-bordered table-striped" style="font-size:12px;">
                                                        <thead>
                                                            <tr>
                                                                <th class="text-center"></th>
                                                                <th class="text-center">Deal #</th>
                                                                <th class="text-center">Make</th>
                                                                <th class="text-center">Price</th>
                                                                <th class="text-center">Cost</th>
                                                                <th class="text-center">Profit</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            @{
                                                                var aftermarketDealIndex = 0;
                                                            }
                                                            @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 1))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                    <tr>
                                                                        <td class="text-center">@aftermarketDealIndex</td>
                                                                        <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                        <td class="text-center">@deal.MakeName</td>
                                                                        <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 1).AftermarketPrice</td>
                                                                        <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 1).AftermarketCost</td>
                                                                        <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 1).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 1).AftermarketCost)</td>

                                                                    </tr>
                                                                }
                                                            }

                                                        </tbody>
                                                        <tfoot></tfoot>
                                                    </table>
                                                </td>
                                            </tr>
                                                                }
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th class="text-center">Totals</th>
                                            <th class="text-center">@TotalUnitCount</th>
                                            <th class="text-center">@afterSalesUnitCount</th>
                                            <th class="text-center">@afterSalesPercent.ToString("P", nfi)</th>
                                            <th class="text-center">@afterSalesAvgDeal.ToString("C", nfi)</th>
                                            <th class="text-center">@afterSalesAvgOverallDeals.ToString("C", nfi)</th>
                                            <th class="text-center">@afterSalesAmount.ToString("C", nfi)</th>
                                        </tr>
                                    </tfoot>
                                </table>
                                <h5>@dealGroup.AutoMall Aftermarket</h5>
                                <table class="table table-bordered table-striped" style="font-size:12px;">

                                    <thead>
                                        <tr>
                                            <th class="text-center">Aftermarket Item</th>
                                            <th class="text-center">Total Unit Count</th>
                                            <th class="text-center">Aftermarket Unit Count</th>
                                            <th class="text-center">Aftermarket Unit %</th>
                                            <th class="text-center">Avg Revenue Per AM Deal</th>
                                            <th class="text-center">Avg Cost Per AM Deal</th>
                                            <th class="text-center">Avg Gross Profit per AM Deal</th>
                                            <th class="text-center">Avg Gross Profit per Deal</th>
                                            <th class="text-center">Total Gross Profit</th>
                                        </tr>
                                    </thead>
                                    <tbody>


                                        @if (NitrogenCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-2">Nitrogen <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@NitrogenUnitCount</td>
                                                <td class="text-center">@NitrogenPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice2.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost2.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit2.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit2.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit2.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-2" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 2))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 2).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 2).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 2).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 2).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (ZurichShieldCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-3">ZurichShield <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@ZurichShieldUnitCount</td>
                                                <td class="text-center">@ZurichShieldPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice3.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost3.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit3.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit3.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit3.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-3" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 3))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 3).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 3).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 3).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 3).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (SelectProtectionCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-4">Select Protection <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@SelectProtectionUnitCount</td>
                                                <td class="text-center">@SelectProtectionPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice4.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost4.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit4.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit4.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit4.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-4" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 4))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 4).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 4).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 4).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 4).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (TireWheelCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-5">Tire and Wheel <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@TireWheelUnitCount</td>
                                                <td class="text-center">@TireWheelPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice5.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost5.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit5.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit5.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit5.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-5" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 5))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 5).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 5).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 5).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 5).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (KeyReplacementCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-6">Key Replacement <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@KeyReplacementUnitCount</td>
                                                <td class="text-center">@KeyReplacementPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice6.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost6.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit6.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit6.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit6.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-6" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 6))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 6).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 6).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 6).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 6).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (WindshieldProtectionCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-7">Windshield Protection <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@WindshieldProtectionUnitCount</td>
                                                <td class="text-center">@WindshieldProtectionPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice7.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost7.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit7.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit7.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit7.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-7" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 7))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 7).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 7).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 7).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 7).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (ExcessWearTearCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-8">Excess Wear and Tear <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@ExcessWearTearUnitCount</td>
                                                <td class="text-center">@ExcessWearTearPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice8.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost8.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit8.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit8.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit8.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-8" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 8))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 8).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 8).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 8).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 8).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (SecureGuardCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-9">Secure Guard <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@SecureGuardUnitCount</td>
                                                <td class="text-center">@SecureGuardPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice9.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost9.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit9.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit9.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit9.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-9" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 9))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 9).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 9).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 9).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 9).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (FitzgeraldTotalPackageCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-10">Fitzgerald Total Package <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@FitzgeraldTotalPackageUnitCount</td>
                                                <td class="text-center">@FitzgeraldTotalPackagePercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice10.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost10.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit10.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit10.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit10.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-10" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 10))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 10).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 10).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 10).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 10).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (RustInhibitorUndercoatingCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-11">Rust Inhibitor/Undercoating <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@RustInhibitorUndercoatingUnitCount</td>
                                                <td class="text-center">@RustInhibitorUndercoatingPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice11.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost11.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit11.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit11.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit11.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-11" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 11))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 11).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 11).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 11).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 11).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (UndercoatingCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-12">Undercoating <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@UndercoatingUnitCount</td>
                                                <td class="text-center">@UndercoatingPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice12.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost12.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit12.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit12.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit12.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-12" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 12))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 12).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 12).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 12).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 12).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (RustInhibitorCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-13">Rust Inhibitor <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@RustInhibitorUnitCount</td>
                                                <td class="text-center">@RustInhibitorPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice13.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost13.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit13.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit13.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit13.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-13" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 13))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 13).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 13).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 13).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 13).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (DataDotsCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-14">Data Dots <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@DataDotsUnitCount</td>
                                                <td class="text-center">@DataDotsPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice14.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost14.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit14.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit14.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit14.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-14" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 14))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 14).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 14).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 14).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 14).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (PaintlessCount > -1)
                                            {


                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-15">Paint and Dent Repair <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@PaintlessUnitCount</td>
                                                <td class="text-center">@PaintlessPercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice15.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost15.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit15.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit15.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit15.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-15" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 15))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 15).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 15).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 15).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 15).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (Misc1Count > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-16">Misc 1 <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@Misc1UnitCount</td>
                                                <td class="text-center">@Misc1Percent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice16.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost16.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit16.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit16.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit16.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-16" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Description</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 16 && x.AftermarketName != "LEASE FEE"))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 16).AftermarketName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 16).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 16).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 16).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 16).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (Misc2Count > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-17">Misc 2 <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@Misc2UnitCount</td>
                                                <td class="text-center">@Misc2Percent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice17.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost17.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit17.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit17.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit17.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-17" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Description</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 17))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 17).AftermarketName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 17).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 17).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 17).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 17).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (Misc3Count > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-18">Misc 3 <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@Misc3UnitCount</td>
                                                <td class="text-center">@Misc3Percent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice18.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost18.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit18.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit18.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit18.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-18" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Description</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 18))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 18).AftermarketName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 18).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 18).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 18).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 18).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }
                                        @if (Misc4Count > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-19">Misc 4 <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@Misc4UnitCount</td>
                                                <td class="text-center">@Misc4Percent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice19.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost19.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit19.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit19.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit19.ToString("C", nfi)</td>
                                            </tr>
                                                    <tr id="collapse-@index-19" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Description</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 19))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 19).AftermarketName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 19).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 19).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 19).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 19).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                        }


                                        @if (dealGroup.AutoMall != "Chambersburg" && dealGroup.AutoMall != "Clearwater")
                                            {


                                                if (MDStateCount > -1)
                                                {
                                                <tr>
                                                    <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-20">MD State Inspection (MEMO) <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                    <td class="text-center">@TotalUnitCount</td>
                                                    <td class="text-center">@MDStateUnitCount</td>
                                                    <td class="text-center">@MDStatePercent.ToString("P", nfi)</td>
                                                    <td class="text-center">@totalAvgPrice20.ToString("C", nfi)</td>
                                                    <td class="text-center">@totalAvgCost20.ToString("C", nfi)</td>
                                                    <td class="text-center">@totalAvgProfit20.ToString("C", nfi)</td>
                                                    <td class="text-center">@totalOverallAvgProfit20.ToString("C", nfi)</td>
                                                    <td class="text-center">@totalProfit20.ToString("C", nfi)</td>
                                                </tr>
                                                    <tr id="collapse-@index-20" class="collapse out" style="background-color:#f5f5f5">
                                                        <td colspan="11">
                                                            <table class="table table-bordered table-striped" style="font-size:12px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center"></th>
                                                                        <th class="text-center">Deal #</th>
                                                                        <th class="text-center">Make</th>
                                                                        <th class="text-center">Price</th>
                                                                        <th class="text-center">Cost</th>
                                                                        <th class="text-center">Profit</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    @{
                                                                        var aftermarketDealIndex = 0;
                                                                    }
                                                                    @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 20))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                            <tr>
                                                                                <td class="text-center">@aftermarketDealIndex</td>
                                                                                <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                                <td class="text-center">@deal.MakeName</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 20).AftermarketPrice</td>
                                                                                <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 20).AftermarketCost</td>
                                                                                <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 20).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 20).AftermarketCost)</td>

                                                                            </tr>
                                                                        }
                                                                    }

                                                                </tbody>
                                                                <tfoot></tfoot>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                                            }
                                                                        }
                                        @if (LeaseFeeCount > -1)
                                            {
                                            <tr>
                                                <td class="text-center"><a data-toggle="collapse" id="@index" style="cursor: pointer;" data-target="#collapse-@index-21">Lease Fee (MEMO) <i class="fa fa-caret-down" aria-hidden="true"></i></a></td>
                                                <td class="text-center">@TotalUnitCount</td>
                                                <td class="text-center">@LeaseFeeUnitCount</td>
                                                <td class="text-center">@LeaseFeePercent.ToString("P", nfi)</td>
                                                <td class="text-center">@totalAvgPrice21.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgCost21.ToString("C", nfi)</td>
                                                <td class="text-center">@totalAvgProfit21.ToString("C", nfi)</td>
                                                <td class="text-center">@totalOverallAvgProfit21.ToString("C", nfi)</td>
                                                <td class="text-center">@totalProfit21.ToString("C", nfi)</td>
                                            </tr>
                                                <tr id="collapse-@index-21" class="collapse out" style="background-color:#f5f5f5">
                                                    <td colspan="11">
                                                        <table class="table table-bordered table-striped" style="font-size:12px;">
                                                            <thead>
                                                                <tr>
                                                                    <th class="text-center"></th>
                                                                    <th class="text-center">Deal #</th>
                                                                    <th class="text-center">Make</th>
                                                                    <th class="text-center">Price</th>
                                                                    <th class="text-center">Cost</th>
                                                                    <th class="text-center">Profit</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                @{
                                                                    var aftermarketDealIndex = 0;
                                                                }
                                                                @foreach (var deal in dealGroup.AftermarketDealDetails)
                                            {
                                                if (deal.AftermarketItems.Exists(x => x.AftermarketId == 16 && x.AftermarketName == "LEASE FEE"))
                                                {
                                                    aftermarketDealIndex += 1;
                                                                        <tr>
                                                                            <td class="text-center">@aftermarketDealIndex</td>
                                                                            <td class="text-center"><a href="@applicationPath/Sales/DealDetail/@deal.DealKey" target="_blank">@deal.DealKey</a></td>
                                                                            <td class="text-center">@deal.MakeName</td>
                                                                            <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 16).AftermarketPrice</td>
                                                                            <td class="text-center">@deal.AftermarketItems.Find(o => o.AftermarketId == 16).AftermarketCost</td>
                                                                            <td class="text-center">@(deal.AftermarketItems.Find(o => o.AftermarketId == 16).AftermarketPrice - deal.AftermarketItems.Find(o => o.AftermarketId == 16).AftermarketCost)</td>

                                                                        </tr>
                                                                    }
                                                                }

                                                            </tbody>
                                                            <tfoot></tfoot>
                                                        </table>
                                                    </td>
                                                </tr>
                                                                    }


                                    </tbody>
                                    <tfoot>

                                        <tr>
                                            <th class="text-center">Totals</th>
                                            <th class="text-center">@TotalUnitCount</th>
                                            <th class="text-center">@AftermarketDealUnitCount</th>
                                            <th class="text-center">@AftermarketPercent.ToString("P", nfi)</th>
                                            <th class="text-center">@aftermarketAvgPrice.ToString("C", nfi)</th>
                                            <th class="text-center">@aftermarketAvgCost.ToString("C", nfi)</th>
                                            <th class="text-center">@aftermarketAvgProfit.ToString("C", nfi)</th>
                                            <th class="text-center">@aftermarketTotalAvgProfit.ToString("C", nfi)</th>
                                            <th class="text-center">@aftermarketProfit.ToString("C", nfi)</th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </td>
                        </tr>
                                                                        }


                                                                        TotalDeals += TotalUnitCount;
                                                                        TotalBPPCount += BPPCount;
                                                                        TotalNitrogenCount += NitrogenCount;
                                                                        TotalZurichShieldCount += ZurichShieldCount;
                                                                        TotalSelectProtectionCount += SelectProtectionCount;
                                                                        TotalTireWheelCount += TireWheelCount;
                                                                        TotalKeyReplacementCount += KeyReplacementCount;
                                                                        TotalWindshieldProtectionCount += WindshieldProtectionCount;
                                                                        TotalExcessWearTearCount += ExcessWearTearCount;
                                                                        TotalSecureGuardCount += SecureGuardCount;
                                                                        TotalFitzgeraldTotalPackageCount += FitzgeraldTotalPackageCount;
                                                                        TotalRustInhibitorUndercoatingCount += RustInhibitorUndercoatingCount;
                                                                        TotalUndercoatingCount += UndercoatingCount;
                                                                        TotalRustInhibitorCount += RustInhibitorCount;
                                                                        TotalDataDotsCount += DataDotsCount;
                                                                        TotalPaintlessCount += PaintlessCount;
                                                                        TotalMisc1Count += Misc1Count;
                                                                        TotalLeaseFeeCount += LeaseFeeCount;
                                                                        TotalMisc2Count += Misc2Count;
                                                                        TotalMisc3Count += Misc3Count;
                                                                        TotalMisc4Count += Misc4Count;
                                                                        TotalMDStateCount += MDStateCount;
                                                                        TotalAftermarketDeals += AftermarketDealCount;

                                                                        TotalFinanceCount += FinanceCount;
                                                                        TotalServiceContractCount += ServiceContractCount;
                                                                        TotalMaintenanceCount += MaintenanceCount;
                                                                        TotalGAPCount += GAPCount;

                                                                        TotalAftermarketPercent = (double)TotalAftermarketDeals / (double)TotalDeals;

                                                                        TotalAftermarketPrice += aftermarketPrice;
                                                                        TotalAftermarketCost += aftermarketCost;
                                                                        TotalAftermarketProfit += aftermarketProfit;
                                                                        TotalVehicleProfit += vehicleProfit;

                                                                        TotalAfterSalesDeals += afterSalesCount;
                                                                        TotalAfterSalesProfit += afterSalesAmount;
                                                                        TotalOverallGrossProfit += TotalGrossProfit;
                                                                    }

                @{
                    TotalAftermarketAvgPrice = (double)TotalAftermarketPrice / (double)TotalAftermarketDeals;
                    TotalAftermarketAvgCost = (double)TotalAftermarketCost / (double)TotalAftermarketDeals;
                    TotalAftermarketAvgProfit = (double)TotalAftermarketProfit / (double)TotalAftermarketDeals;

                    TotalAftermarketTotalAvgProfit = (double)TotalAftermarketProfit / (double)TotalDeals;
                    TotalVehicleAvgProfit = (double)TotalVehicleProfit / (double)TotalDeals;

                    TotalFinancePercent = (double)TotalFinanceCount / (double)TotalDeals;
                    TotalServiceContractPercent = (double)TotalServiceContractCount / (double)TotalDeals;
                    TotalMaintenancePercent = (double)TotalMaintenanceCount / (double)TotalDeals;
                    TotalGAPPercent = (double)TotalGAPCount / (double)TotalDeals;

                    TotalBPPPercent = (double)TotalBPPCount / (double)TotalDeals;
                    TotalNitrogenPercent = (double)TotalNitrogenCount / (double)TotalDeals;
                    TotalZurichShieldPercent = (double)TotalZurichShieldCount / (double)TotalDeals;
                    TotalSelectProtectionPercent = (double)TotalSelectProtectionCount / (double)TotalDeals;
                    TotalTireWheelPercent = (double)TotalTireWheelCount / (double)TotalDeals;
                    TotalKeyReplacementPercent = (double)TotalKeyReplacementCount / (double)TotalDeals;
                    TotalWindshieldProtectionPercent = (double)TotalWindshieldProtectionCount / (double)TotalDeals;
                    TotalExcessWearTearPercent = (double)TotalSecureGuardCount / (double)TotalDeals;
                    TotalSecureGuardPercent = (double)TotalSecureGuardCount / (double)TotalDeals;
                    TotalFitzgeraldTotalPackagePercent = (double)TotalFitzgeraldTotalPackageCount / (double)TotalDeals;
                    TotalRustInhibitorUndercoatingPercent = (double)TotalRustInhibitorUndercoatingCount / (double)TotalDeals;
                    TotalUndercoatingPercent = (double)TotalUndercoatingCount / (double)TotalDeals;
                    TotalRustInhibitorPercent = (double)TotalRustInhibitorCount / (double)TotalDeals;
                    TotalDataDotsPercent = (double)TotalDataDotsCount / (double)TotalDeals;
                    TotalPaintlessPercent = (double)TotalPaintlessCount / (double)TotalDeals;
                    TotalMisc1Percent = (double)TotalMisc1Count / (double)TotalDeals;
                    TotalLeaseFeePercent = (double)TotalLeaseFeeCount / (double)TotalDeals;
                    TotalMisc2Percent = (double)TotalMisc2Count / (double)TotalDeals;
                    TotalMisc3Percent = (double)TotalMisc3Count / (double)TotalDeals;
                    TotalMisc4Percent = (double)TotalMisc4Count / (double)TotalDeals;
                    TotalMDStatePercent = (double)TotalMDStateCount / (double)TotalDeals;

                    TotalAfterSalesPercent = (double)TotalAfterSalesDeals / (double)TotalDeals;

                    TotalAfterSalesPerDeal = (double)TotalAfterSalesProfit / (double)TotalAfterSalesDeals;
                    TotalAfterSalesPerTotalDeals = (double)TotalAfterSalesProfit / (double)TotalDeals;

                    TotalAvgOverallGrossProfit = (double)TotalOverallGrossProfit / (double)TotalDeals;

                }
            </tbody>
            <tfoot>
                <tr>


                    <th class="text-center">Totals</th>
                    <th class="text-center">@TotalDeals</th>
                    <th class="text-center">@TotalAfterSalesDeals</th>
                    <th class="text-center">@TotalAfterSalesPercent.ToString("P", nfi)</th>
                    <th class="text-center">@TotalAfterSalesPerDeal.ToString("C", nfi)</th>
                    <th class="text-center">@TotalAfterSalesPerTotalDeals.ToString("C", nfi)</th>
                    <th class="text-center extra-right">@TotalAfterSalesProfit.ToString("C", nfi)</th>
                    <td class="text-center aft">@TotalFinanceCount</td>
                    <td class="text-center extra-right aft-percent">@TotalFinancePercent.ToString("P", nfi)</td>
                    <td class="text-center aft">@TotalServiceContractCount</td>
                    <td class="text-center extra-right aft-percent">@TotalServiceContractPercent.ToString("P", nfi)</td>
                    <td class="text-center aft">@TotalMaintenanceCount</td>
                    <td class="text-center extra-right aft-percent">@TotalMaintenancePercent.ToString("P", nfi)</td>
                    <td class="text-center aft">@TotalGAPCount</td>
                    <td class="text-center extra-right aft-percent">@TotalGAPPercent.ToString("P", nfi)</td>
                    <th class="text-center aft">@TotalBPPCount</th>
                    <th class="text-center extra-right aft-percent">@TotalBPPPercent.ToString("P", nfi)</th>

                    <th class="text-center">@TotalAftermarketDeals</th>
                    <th class="text-center">@TotalAftermarketPercent.ToString("P", nfi)</th>

                    @*<th class="text-center">@TotalAftermarketAvgPrice.ToString("C", nfi)</th>
                        <th class="text-center">@TotalAftermarketAvgCost.ToString("C", nfi)</th>*@
                    <th class="text-center">@TotalAftermarketAvgProfit.ToString("C", nfi)</th>
                    <th class="text-center">@TotalAftermarketTotalAvgProfit.ToString("C", nfi)</th>
                    <th class="text-center extra-right">@TotalAftermarketProfit.ToString("C", nfi)</th>
                    <th class="text-center">@TotalOverallGrossProfit.ToString("C", nfi)</th>
                    <th class="text-center">@TotalAvgOverallGrossProfit.ToString("C", nfi)</th>
                    @*<th class="text-center">@TotalVehicleAvgProfit.ToString("C", nfi)</th>*@


                    <th class="text-center aft">@TotalNitrogenCount</th>
                    <th class="text-center extra-right aft-percent">@TotalNitrogenPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalZurichShieldCount</th>
                    <th class="text-center extra-right aft-percent">@TotalZurichShieldPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalSelectProtectionCount</th>
                    <th class="text-center extra-right aft-percent">@TotalSelectProtectionPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalTireWheelCount</th>
                    <th class="text-center extra-right aft-percent">@TotalTireWheelPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalKeyReplacementCount</th>
                    <th class="text-center extra-right aft-percent">@TotalKeyReplacementPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalWindshieldProtectionCount</th>
                    <th class="text-center extra-right aft-percent">@TotalWindshieldProtectionPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalExcessWearTearCount</th>
                    <th class="text-center extra-right aft-percent">@TotalExcessWearTearPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalSecureGuardCount</th>
                    <th class="text-center extra-right aft-percent">@TotalSecureGuardPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalFitzgeraldTotalPackageCount</th>
                    <th class="text-center extra-right aft-percent">@TotalFitzgeraldTotalPackagePercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalRustInhibitorUndercoatingCount</th>
                    <th class="text-center extra-right aft-percent">@TotalRustInhibitorUndercoatingPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalUndercoatingCount</th>
                    <th class="text-center extra-right aft-percent">@TotalUndercoatingPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalRustInhibitorCount</th>
                    <th class="text-center extra-right aft-percent">@TotalRustInhibitorPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalDataDotsCount</th>
                    <th class="text-center extra-right aft-percent">@TotalDataDotsPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalPaintlessCount</th>
                    <th class="text-center extra-right aft-percent">@TotalPaintlessPercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalMisc1Count</th>
                    <th class="text-center extra-right aft-percent">@TotalMisc1Percent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalMisc2Count</th>
                    <th class="text-center extra-right aft-percent">@TotalMisc2Percent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalMisc3Count</th>
                    <th class="text-center extra-right aft-percent">@TotalMisc3Percent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalMisc4Count</th>
                    <th class="text-center extra-right aft-percent">@TotalMisc4Percent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalMDStateCount</th>
                    <th class="text-center extra-right aft-percent">@TotalMDStatePercent.ToString("P", nfi)</th>
                    <th class="text-center aft">@TotalLeaseFeeCount</th>
                    <th class="text-center extra-right aft-percent">@TotalLeaseFeePercent.ToString("P", nfi)</th>
                </tr>
            </tfoot>
        </table>
    </div>



                    }

@section scripts
{


    <script src="~/Scripts/Chosen/chosen.jquery.js" type="text/javascript"></script>
    <script src="~/Scripts/Chosen/docsupport/prism.js" type="text/javascript" charset="utf-8"></script>
    <script src="~/Scripts/Chosen/docsupport/init.js" type="text/javascript" charset="utf-8"></script>

    <script type="text/javascript">


        $(document).ready(function () {
            $('#btnToggleAftermarketItems').click(function () {


                if ($('#btnToggleAftermarketItems').val() == 'Show Aftermarket Items') {
                    $('.aft').show();
                    $('#btnToggleAftermarketItems').val("Hide Aftermarket Items");
                }
                else {
                    $('.aft').hide();
                    $('#btnToggleAftermarketItems').val("Show Aftermarket Items");
                }

            });
            $('#btnToggleAftermarketPercentage').click(function () {
                if ($('#btnToggleAftermarketPercentage').val() == 'Show Aftermarket Percentages')
                {
                    $('.aft-percent').show();
                    $('#btnToggleAftermarketPercentage').val("Hide Aftermarket Percentages");
                }
                else
                {
                    $('.aft-percent').hide();
                    $('#btnToggleAftermarketPercentage').val("Show Aftermarket Percentages");
                }

            });

            $('[data-toggle="tooltip"]').tooltip();

            $('#section1').DataTable({
                searching: false,
                sorting: false,
                ordering: false,
                dom: 'B',
                pageLength: -1,
                buttons: [
                    {
                        extend: 'copyHtml5', footer: true,
                    },
                    {
                        extend: 'excelHtml5', footer: true,
                    },
                    {
                        extend: 'pdfHtml5', footer: true,
                        orientation: 'landscape'
                    },
                    {
                        extend: 'print', footer: true,
                        orientation: 'landscape'
                    }]

            });

        });





    </script>

}